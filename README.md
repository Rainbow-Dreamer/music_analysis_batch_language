# music_analysis_batch_language

这是我设计的一门可以快速输入作曲分析内容的语言，可以对你输入的调性，和弦，和弦级数以及作曲手法的讲解等等  
进行批量排版，让你用很简洁的语法输入漂亮的作曲分析，和弦级数(一般为roman numerals)会自动与对应的和弦  
进行对齐，并且可以指定当前正在演奏的是哪一个和弦。也可以自己设定相邻和弦之间的间隔（空格的数量），  
也可以设置小节线的字符等等。接下来我讲解一下这门语言基本的语法。  
首先是输入调性，语法为：
```
k.调性
```
调性可以是任意的你想写的表示调性的内容，比如A大调，A major等等，以上的语法就会生成
```
key: 调性
```
此外，也可以自己定制调性的开头内容，语法为
```
k!调性开头的内容
```
这样就可以自己定制调性前的内容，默认为`key: `

然后是输入和弦进行以及对应的作曲分析的和弦级数(一般为roman numerals)，语法为  
```
当前小节数;和弦1;和弦2;和弦3;...$和弦级数1;和弦级数2;和弦级数3;...$其他的参数定制
```
首先，第一个参数是小节数，可以是任意的数字，整数，小数，分数都可以（实际上可以是任意的字符串）  
然后用`;`与和弦部分间隔开，然后每两个和弦之间也是使用`;`分隔，可以写任意多个，然后使用`$`作为结束，  
后面可以写和弦级数的内容，同样也是使用`;`分隔，然后也是以`$`作为结束，后面可以跟着其他的参数配置。  
如果要显示当前正在演奏的和弦，语法是在想要显示当前正在演奏的和弦名称前面加上`!`，  
比如想要显示当前正在演奏和弦2，那么可以写
```
当前小节数;和弦1;!和弦2;和弦3;...$和弦级数1;和弦级数2;和弦级数3;...$其他的参数定制
```
这里值得一提的是，我这个语言的设计是会把最后一个有`!`在前面的和弦名称作为显示当前正在演奏的和弦，  
因此你可以在多个和弦前面加上`!`，只需要保证最后一个`!`在你想要在当前显示的和弦前面就行了。


可以使用的参数配置：  
* c=作曲手法的文字说明  (可以加上当前小节的和弦的作曲手法分析的文字说明)

* i=间隔  (可以设定每两个和弦之间的空格数量)

* b=是否显示当前小节数  (如果为T,则显示当前小节数（把第一个参数作为当前小节数显示），如果为F，则不显示当前小节数（第一个参数作为第一个和弦）)

* s=小节线字符  (可以设定小节线的字符，默认为`|`)

* a=当前正在演奏的和弦的字符  (可以设定当前正在演奏的和弦的字符，默认为`→`)

* ca=是否显示和弦级数  (如果为T，则显示和弦级数，如果为F，则不显示和弦级数)

接下来我演示一下具体的实现效果，
```
1;Cmaj7;Dm11;G9sus;Cmaj9#11$IM7;ii11;V9sus;IM9#11
```
可以生成
```
1
Cmaj7 | Dm11 | G9sus | Cmaj9#11
IM7     ii11   V9sus   IM9#11
```
每一个和弦与和弦级数都会自动对齐，省去了自己排版的麻烦。  
如果是要显示当前正在演奏的和弦，那么可以写
```
1;Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)$IM7;II7;IVM7;IM9
```
可以生成
```
1
Cmaj7 | → D7 | Fmaj7 | Cmaj9(omit 3)
IM7       II7  IVM7    IM9
```
而且还有各种参数配置可以自己定制生成的内容，比如想要加上作曲说明，可以写
```
1;Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)$IM7;II7;IVM7;IM9$c=C大调中借用同主音C lydian调式的2级属七和弦
```
可以生成
```
1
Cmaj7 | → D7 | Fmaj7 | Cmaj9(omit 3)
IM7       II7  IVM7    IM9
C大调中借用同主音C lydian调式的2级属七和弦
```
如果想要输入多行的作曲说明，只需要在换行时打上一个换行符`\n`就行了。  
如果不想显示作曲分析的和弦级数的内容，可以直接不写，
```
1;Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)
```
可以生成
```
1
Cmaj7 | → D7 | Fmaj7 | Cmaj9(omit 3)
```
如果不想显示作曲分析的和弦级数的内容，但是又需要参数配置，比如不想显示当前小节数，  
那么可以在写作曲分析的部分写`.`或者`~`或者直接留空，
```
Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)$$b=F
```
可以生成
```
Cmaj7 | → D7 | Fmaj7 | Cmaj9(omit 3)
```
接下来我演示一些参数配置的效果，比如更改间隔，
```
1;Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)$IM7;II7;IVM7;IM9$i=2
```
可以生成
```
1
Cmaj7  |  → D7  |  Fmaj7  |  Cmaj9(omit 3)
IM7         II7    IVM7      IM9
```
现在每两个和弦之间的到小节线的空格数量都是2了。  
显示当前的调性，
```
k.A大调
```
可以生成
```
key: A大调
```
设定当前的调性前面的内容，
```
k!当前调性: 
```
然后再写
```
k.A大调
```
可以生成
```
当前调性: A大调
```
每两个不同小节的作曲分析之间可以空任意多行，生成的结果也是空一样多的行，比如
```
1;!Cmaj7;D7;Fmaj7;Cmaj9(omit 3)$IM7;II7;IVM7;IM9

2;Cmaj7;!D7;Fmaj7;Cmaj9(omit 3)$IM7;II7;IVM7;IM9
```
可以生成
```
1
→ Cmaj7 | D7 | Fmaj7 | Cmaj9(omit 3)
  IM7     II7  IVM7    IM9

2
Cmaj7 | → D7 | Fmaj7 | Cmaj9(omit 3)
IM7       II7  IVM7    IM9
```
另外，当前小节数实际上可以写`+相对上一个小节的距离`，这个距离的单位也是小节，  
比如第一个当前小节数是1，然后过了1/2个小节开始演奏下一个和弦，那么可以写`+1/2`，  
这种语法实际上在我写的钢琴软件Ideal Piano里面是可以直接解析的，我专门写了语法解析的函数逻辑  
来进行小节数的推算。Ideal Piano同时支持绝对小节数和相对小节数，并且可以直接读取上面的  
生成的内容那样的作曲分析内容并且在软件里播放midi文件的时候按照小节实时显示作曲分析的内容。

我为这门语言专门写了一个编辑器，在左边写代码，右边会实时生成对应的作曲内容，还有语法高亮等功能。

